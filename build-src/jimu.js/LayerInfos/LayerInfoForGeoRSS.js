// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/array dojo/Deferred esri/lang jimu/utils ./LayerInfo".split(" "),function(f,e,g,h,k,l){return f(l,{constructor:function(){},_getExtent:function(){var b=new g,a=this.layerObject.items,c=this.layerObject.fullExtent||this.layerObject.initialExtent;0===a.length?b.resolve(c):b.resolve(k.graphicsExtent(a));return b},_resetLayerObjectVisiblity:function(b){var a=b?b[this.id]:null;if(a){var c={},d;for(d in b)b.hasOwnProperty(d)&&"function"!==typeof b[d]&&(c[d]=b[d].visible);
this._setSubLayerVisibleByCheckedInfo(c);this._setTopLayerVisible(a.visible)}},_setSubLayerVisibleByCheckedInfo:function(b){e.forEach(this.newSubLayers,function(a){h.isDefined(b[a.id])&&a.layerObject.setVisibility(b[a.id])},this)},_initVisible:function(){var b=!1,a;for(a=0;a<this.newSubLayers.length;a++)b=b||this.newSubLayers[a].layerObject.visible;b&&(this._visible=!0)},_setTopLayerVisible:function(b){this._visible=b?!0:!1;e.forEach(this.newSubLayers,function(a){a.setLayerVisiblefromTopLayer()},
this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var b=[],a=this.layerObject.getFeatureLayers();e.forEach(a,function(a){a=this._layerInfoFactory.create({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" ",subId:a.id||" ",collection:{layerInfo:this},selfType:"geo_rss",parentLayerInfo:this});b.push(a);a.init()},this);this._markInvalidSubLayerInfoThatAsRootLayer(a);return b},_markInvalidSubLayerInfoThatAsRootLayer:function(b){var a;e.forEach(b,function(b){if(a=this._getLayerInfosObj()._findTopLayerInfoById(b.id))a._flag._invalid=
!0},this)},_needToRenew:function(){var b=this.layerObject.getFeatureLayers();return(b?b.length:0)===this.newSubLayers.length?!1:!0},_obtainLayerIndexesInMap:function(){var b=[],a,c;for(c=0;c<this.newSubLayers.length;c++)(a=this._getLayerIndexesInMapByLayerId(this.newSubLayers[c].layerObject.id))&&b.push(a);return b},moveLeftOfIndex:function(b){var a;for(a=this.newSubLayers.length-1;0<=a;a--)this.map.reorderLayer(this.newSubLayers[a].layerObject,b)},moveRightOfIndex:function(b){var a;for(a=0;a<this.newSubLayers.length;a++)this.map.reorderLayer(this.newSubLayers[a].layerObject,
b)}})});