// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),function(g,m,q,h,c,d,e,k,p,l,b,a,f,n,x,r,u,C){var t=q([h,c,d,m],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',
_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new C({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();
this._createTree();this.basicFilter=a.hitch(this,this.basicFilter);this.filter=t.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new k;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new k;a.resolve(!0);return a},getSelectedItems:function(){var b=this.tree.getSelectedItems();return n.map(b,a.hitch(this,function(a){return this.getHandledItem(a)}))},
getAllItems:function(){var b=this.tree.getAllItems(),f=[];n.forEach(b,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),f.push(a))}));return f},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(b){this.createMapResponse=b;u.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(g(this.layerInfosObj,"layerInfosChanged",
a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(g(this.layerInfosObj,"layerInfosIsShowInMapChanged",a.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(b){this._clear();f.setStyle(this.errorTipSection,
"display","block");var c=[];this.onlyShowWebMapLayers?(c=b.getLayerInfoArrayOfWebmap(),c=c.concat(b.getTableInfoArrayOfWebmap())):(c=b.getLayerInfoArray(),c=c.concat(b.getTableInfoArray()));0!==c.length&&(f.setStyle(this.errorTipSection,"display","none"),n.forEach(c,a.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(b){b&&b.getLayerObject().then(a.hitch(this,function(){this._addItem("root",b)}),a.hitch(this,function(a){console.error(a)}))},_clear:function(){var b=
this._store.query({parent:"root"});n.forEach(b,a.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(f,c){var d=null,e=c.getLayerType(),z=this.filter(c);b({layerType:e,valid:z}).then(a.hitch(this,function(e){if(e.valid){var z=a.hitch(this,function(a,b){this._id++;d={name:c.title||"",parent:f,layerInfo:c,type:e.layerType,layerClass:c.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:b};this._store.add(d)}),k=c.getSubLayers(),g=0===k.length;g?
z(g,!1):(k=n.map(k,a.hitch(this,function(a){return this.filter(a)})),b(k).then(a.hitch(this,function(a){(a=n.some(a,function(a){return a}))&&z(g,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var b=this._getRootItem(),b=new e({data:[b],getChildren:function(a){return this.query({parent:a.id})}});this._store=new p(b);b=new l({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=
new r({multiple:this.multiple,model:b,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:a.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:a.hitch(this,function(a,b,f){this._onTreeClick(a,b,f);this.emit("tree-click",a,b,f)}),getIconStyle:a.hitch(this,function(a,b){var f=null;if(!a||"root"===a.id)return null;var c={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},d=window.location.protocol+
"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconInfo(a,b).imageName)c.backgroundImage="url("+d+"/css/images/"+a+")",f=c;return f}),getIconClass:a.hitch(this,function(a,b){return this._getIconInfo(a,b).className}),getTooltip:a.hitch(this,function(a){return this.displayTooltipForTreeNode?a.layerInfo.title:""})});f.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,
b){var f="",c="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(f="mapserver_open.png",c="mapservice-layer-icon open"):(f="mapserver_close.png",c="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(f="group_layer2.png",c="group-layer-icon open"):(f="group_layer1.png",c="group-layer-icon close"):"FeatureLayer"===a.type?(a=x.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(f="point_layer1.png",c="point-layer-icon"):"polyline"===a?(f="line_layer1.png",
c="line-layer-icon"):"polygon"===a&&(f="polygon_layer1.png",c="polygon-layer-icon")):"Table"===a.type?(f="table.png",c="table-icon"):"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===a.type?(f="image_layer.png",c="iamge-layer-icon"):b?(f="mapserver_open.png",c="mapservice-layer-icon open"):(f="mapserver_close.png",c="mapservice-layer-icon close");return{imageName:f,className:c}},_onTreeOpen:function(f,c){if("root"!==f.id){var d=[];c=[];d=f.layerInfo.getSubLayers();f.checked||(this.shelter.show(),
c=n.map(d,a.hitch(this,function(a){return a.getLayerObject()})),b(c).then(a.hitch(this,function(){this.domNode&&(n.forEach(d,a.hitch(this,function(a){this._addItem(f.id,a)})),f.checked=!0,this.shelter.hide())}),a.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,b,f){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});t.createFilterByLayerType=function(f){a.isArrayLike(f)||
(f=[]);return function(a){var c=new k;if(0===f.length)c.resolve(!0);else{var d=[];a.traversal(function(a){d.push(a.getLayerType())});b(d).then(function(a){for(var b=0;b<a.length;b++)for(var d=0;d<f.length;d++)if(a[b]===f[d]){c.resolve(!0);return}c.resolve(!1)},function(a){console.error(a);c.reject(a)})}return c}};t.createFeaturelayerFilter=function(a,f,c,d){var e=["point","polyline","polygon"];a&&0<a.length?(a=n.filter(a,function(a){return 0<=e.indexOf(a)}),0===a.length&&(a=e)):a=e;return function(e){var k=
e.getLayerType();e=e.getLayerObject();return b({layerType:k,layerObject:e}).then(function(b){var e=b.layerType;b=b.layerObject;if("ArcGISDynamicMapServiceLayer"===e||"ArcGISTiledMapServiceLayer"===e||"GroupLayer"===e||"FeatureCollection"===e)return!0;if("FeatureLayer"===e){var e=x.getTypeByGeometryType(b.geometryType),e=0<=n.indexOf(a,e),k=t._shouldPassStatisticsCheck(d,b);return b.url?(b=x.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),e&&b&&k):f&&e}return"Table"===e?(e=x.isFeaturelayerUrlSupportQuery(b.url,
b.capabilities),b=t._shouldPassStatisticsCheck(d,b),c&&e&&b):!1})}};t.createImageServiceLayerFilter=function(a,f){return function(c){var d=c.getLayerType();c=c.getLayerObject();return b({layerType:d,layerObject:c}).then(function(b){var c=b.layerType,d=b.layerObject;return"ArcGISImageServiceLayer"===c||"ArcGISImageServiceVectorLayer"===c?a?x.isImageServiceSupportQuery(b.layerObject.capabilities)?f?t._shouldPassStatisticsCheck(f,d):!0:!1:!0:!1})}};t._shouldPassStatisticsCheck=function(a,b){return a?
(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};t.createQueryableLayerFilter=function(a){var b=t.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=t.createImageServiceLayerFilter(!0,a);return t.orCombineFilters([b,a])};t.andCombineFilters=function(a){return t._combineFilters(a,!0)};t.orCombineFilters=function(a){return t._combineFilters(a,!1)};t._combineFilters=function(a,f){return function(c){var d=new k,e=n.map(a,
function(a){return a(c)});b(e).then(function(a){var b=!1,b=f?n.every(a,function(a){return a}):n.some(a,function(a){return a});d.resolve(b)},function(a){console.error(a);d.reject(a)});return d}};return t})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(g,m,q,h,c,d,e){return q("dijit.tree.ObjectStoreModel",e,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,
constructor:function(d){c.mixin(this,d);this.childrenCache={}},getRoot:function(e,g){if(this.root)e(this.root);else{var k=this.store.query(this.query);k.then&&this.own(k);d(k,c.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];e(this.root);k.observe&&k.observe(c.hitch(this,function(a){this.onChange(a)}),!0)}),g)}},mayHaveChildren:function(){return!0},getChildren:function(e,g,h){var b=
this.store.getIdentity(e);if(this.childrenCache[b])d(this.childrenCache[b],g,h);else{var a=this.childrenCache[b]=this.store.getChildren(e);a.then&&this.own(a);a.observe&&this.own(a.observe(c.hitch(this,function(b,n,k){this.onChange(b);n!=k&&d(a,c.hitch(this,"onChildrenChange",e))}),!0));d(a,g,h)}},isItem:function(){return!0},getIdentity:function(c){return this.store.getIdentity(c)},getLabel:function(c){return c[this.labelAttr]},newItem:function(c,d,e,b){return this.store.put(c,{parent:d,before:b})},
pasteItem:function(d,e,l,b,a,f){var n=new h;if(e===l&&!b&&!f)return n.resolve(!0),n;e&&!b?this.getChildren(e,c.hitch(this,function(a){a=[].concat(a);var b=g.indexOf(a,d);a.splice(b,1);this.onChildrenChange(e,a);n.resolve(this.store.put(d,{overwrite:!0,parent:l,oldParent:e,before:f,isCopy:!1}))})):n.resolve(this.store.put(d,{overwrite:!0,parent:l,oldParent:e,before:f,isCopy:!0}));return n},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(g,m,q,h,c,d,e,k,p,l,b,a,f,n,x,r){var u=g([x._TreeNode,f],{templateString:h,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=d.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=d.toDom('\x3cinput type\x3d"checkbox" /\x3e');d.addClass(this.checkNode,"jimu-tree-check-node");d.place(this.checkNode,this.contentNode,
"first");this.own(b(this.checkNode,"click",c.hitch(this,this._onClick)));this.own(b(this.rowNode,"keydown",c.hitch(this,function(b,f){f.target=b;f.keyCode!==a.ENTER&&f.keyCode!==a.SPACE||this._onClick(f)},this.checkNode)));this.isLeaf?this.groupId?d.setStyle(this.checkNode,"display","none"):d.setStyle(this.checkNode,"display","inline"):d.setStyle(this.checkNode,"display","none");this.isLeaf?d.addClass(this.domNode,"jimu-tree-leaf-node"):d.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,d.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,d.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(c.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return g([x,f],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+r.getRandomString()},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,"jimu-tree");this.own(l.before(this,"onClick",c.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&d.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;d.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return e.map(a,c.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=e.filter(a,c.hitch(this,function(a){return a.checkNode.checked}));return e.map(a,
c.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=e.map(b,c.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return e.filter(b,c.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),f=0;f<b.length;f++){var c=n.byNode(b[f]);if(c.item.id.toString()===a.toString())return c}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return e.filter(a,c.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return e.map(a,c.hitch(this,function(a){return n.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return p(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new u(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,f){b.isLeaf&&(d.hasClass(f.target||f.srcElement,"jimu-tree-check-node")||(this.multiple?b.toggleSelect():this.selectNodeWidget(b)));return arguments},_onCheckNodeClick:function(a,
b,f){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();k.stop(f);this.focusNode(a);setTimeout(c.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,f)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();e.forEach(a,c.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(g,m,q,h,c,d,e,k,p,l,b,a,f,n,x,r,u,C,t,z,E,K,B,F,G,I,J,M,H,L,N,O,R,P,Q){function v(a){return r.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var D=h("dijit._TreeNode",[G,I,J,M,H],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);f("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:N,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";l.set(this.domNode,
"backgroundPosition",b+" 0px");l.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);g.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,w=b.model;b._v10Compat&&a===w.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,f){var w="_"+b+"Class";b+="Node";var c=this[w];this[w]=this.tree["get"+f+"Class"](a,this.isExpanded);k.replace(this[b],this[w]||"",c||"");l.set(this[b],this.tree["get"+f+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;k.toggle(this.domNode,"dijitTreeIsRoot",a);k.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;k.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return v(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");k.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:F.defaultDuration}),f=this._expandDeferred=new c(function(){b.stop()});m.after(b,"onEnd",function(){f.resolve(!0)},!0);b.play();return v(f)},collapse:function(){if(this._collapseDeferred)return v(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");k.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:F.defaultDuration}),f=this._collapseDeferred=new c(function(){b.stop()});m.after(b,"onEnd",
function(){f.resolve(!0)},!0);b.play();return v(f)},indent:0,setChildItems:function(a){var b=this.tree,f=b.model,w=[],c=b.focusedChild,n=this.getChildren();g.forEach(n,function(a){J.prototype.removeChild.call(this,a)},this);this.defer(function(){g.forEach(n,function(a){if(!a._destroyed&&!a.getParent()){var w=function(a){var c=f.getIdentity(a.item),d=b._itemNodesMap[c];1==d.length?delete b._itemNodesMap[c]:(c=g.indexOf(d,a),-1!=c&&d.splice(c,1));g.forEach(a.getChildren(),w)};b.dndController.removeTreeNode(a);
w(a);if(b.persist){var d=g.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),y;for(y in b._openedNodes)y.substr(0,d.length)==d&&delete b._openedNodes[y];b._saveExpandedNodes()}b.lastFocusedChild&&!e.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;c&&!e.isDescendant(c.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,g.forEach(a,function(a){var c=f.getIdentity(a),d=b._itemNodesMap[c],
e;if(d)for(var y=0;y<d.length;y++)if(d[y]&&!d[y].getParent()){e=d[y];e.set("indent",this.indent+1);break}e||(e=this.tree._createTreeNode({item:a,tree:b,isExpandable:f.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),d?d.push(e):b._itemNodesMap[c]=[e]);this.addChild(e);(this.tree.autoExpand||this.tree._state(e))&&w.push(b._expandNode(e))},this),g.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=d(w);this.tree._startPaint(a);return v(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());g.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");k.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){K.focus(this.focusNode)}});f("dojo-bidi")&&D.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),g.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var A=h("dijit.Tree",[G,L,I,H],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:O,persist:!1,autoExpand:!1,dndController:Q,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){C.publish(this.id,r.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new c;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(u(this.containerNode,
u.selector(".dijitTreeNode",t.enter),function(b){a._onNodeMouseEnter(B.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeNode",t.leave),function(b){a._onNodeMouseLeave(B.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",E.press),function(b){a._onNodePress(B.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",E),function(b){a._onClick(B.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(B.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(m.after(this.model,"onChange",r.hitch(this,"_onItemChange"),!0),m.after(this.model,"onChildrenChange",r.hitch(this,"_onItemChildrenChange"),!0),m.after(this.model,"onDelete",r.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){r.isString(this.dndController)&&(this.dndController=r.getObject(this.dndController));for(var b={},f=0;f<this.dndParams.length;f++)this[this.dndParams[f]]&&(b[this.dndParams[f]]=this[this.dndParams[f]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=v(this.pendingCommandsPromise);this.onLoadDeferred.then(r.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;n.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=r.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=r.hitch(this,function(a,b,f){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,f)}));this.model=new P(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(r.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(r.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),r.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=r.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(r.hitch(this,function(){var f=
g.map(a,function(a){return!a||r.isString(a)?a:b.model.getIdentity(a)}),c=[];g.forEach(f,function(a){c=c.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",c)}))},_setPathAttr:function(a){return a.length?v(this.set("paths",[a]).then(function(a){return a[0]})):v(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,c){var d=a.shift(),e=g.filter(c,function(a){return a.getIdentity()==d})[0];if(e)return a.length?f._expandNode(e).then(function(){return b(a,
e.getChildren())}):e;throw new A.PathError("Could not expand path at "+d);}var f=this;return v(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return d(g.map(a,function(a){a=g.map(a,function(a){return a&&r.isObject(a)?f.model.getIdentity(a):a});if(a.length)return b(a,[f.rootNode]);throw new A.PathError("Empty path");}))}).then(function(a){f.set("selectedNodes",a);return f.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(f){return b._expandNode(f).then(function(){var b=g.filter(f.getChildren()||[],function(a){return a.isExpandable});return d(g.map(b,a))})}var b=this;return v(a(this.rootNode))},collapseAll:function(){function a(f){var c=g.filter(f.getChildren()||[],function(a){return a.isExpandable}),c=d(g.map(c,a));return!f.isExpanded||f==b.rootNode&&!b.showRoot?c:c.then(function(){return b._collapseNode(f)})}var b=this;return v(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return e.isDescendant(a,
b.expandoNode)||e.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,f,c){var d=this.isExpandoNode(b.target,a);a.isExpandable&&(f||d)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[c](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){n.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){n.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,f=a.item,d=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new c,b.getChildren(f,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(d,": error loading "+a.label+" children: ",
b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(r.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var f=this.getLabel(a),c=this.getTooltip(a);g.forEach(b,function(b){b.set({item:a,
label:f,tooltip:c});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&g.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(g.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!e.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&
!e.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=q(this.cookieName);a&&g.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var f=g.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[f];b?this._openedNodes[f]=
!0:delete this._openedNodes[f];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);q(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!r.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},
resize:function(a){a&&p.setMarginBox(this.domNode,a);this._nodePixelIndent=p.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(r.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=r.hitch(this,function(){this._outstandingPaintOperations--;
0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});z(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new D(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):
this.focusFirstChild()}});f("dojo-bidi")&&A.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});A.PathError=b("TreePathError");A._TreeNode=D;return A})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(g,m,q,h){return q("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,
constructor:function(c){h.mixin(this,c);this.connects=[];c=this.store;if(!c.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");c.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([m.after(c,"onNew",h.hitch(this,"onNewItem"),!0),m.after(c,"onDelete",h.hitch(this,"onDeleteItem"),!0),m.after(c,"onSet",h.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var c;c=this.connects.pop();)c.remove()},getRoot:function(c,
d){this.root?c(this.root):this.store.fetch({query:this.query,onComplete:h.hitch(this,function(d){if(1!=d.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+d.length+" items, but must return exactly one");this.root=d[0];c(this.root)}),onError:d})},mayHaveChildren:function(c){return g.some(this.childrenAttrs,function(d){return this.store.hasAttribute(c,d)},this)},getChildren:function(c,d,e){var k=this.store;if(k.isItemLoaded(c)){for(var p=[],l=0;l<this.childrenAttrs.length;l++)var b=
k.getValues(c,this.childrenAttrs[l]),p=p.concat(b);var a=0;this.deferItemLoadingUntilExpand||g.forEach(p,function(b){k.isItemLoaded(b)||a++});0==a?d(p):g.forEach(p,function(b,f){k.isItemLoaded(b)||k.loadItem({item:b,onItem:function(b){p[f]=b;0==--a&&d(p)},onError:e})})}else{var f=h.hitch(this,arguments.callee);k.loadItem({item:c,onItem:function(a){f(a,d,e)},onError:e})}},isItem:function(c){return this.store.isItem(c)},fetchItemByIdentity:function(c){this.store.fetchItemByIdentity(c)},getIdentity:function(c){return this.store.getIdentity(c)},
getLabel:function(c){return this.labelAttr?this.store.getValue(c,this.labelAttr):this.store.getLabel(c)},newItem:function(c,d,e){var k={parent:d,attribute:this.childrenAttrs[0]},g;this.newItemIdAttr&&c[this.newItemIdAttr]?this.fetchItemByIdentity({identity:c[this.newItemIdAttr],scope:this,onItem:function(h){h?this.pasteItem(h,null,d,!0,e):(g=this.store.newItem(c,k))&&void 0!=e&&this.pasteItem(g,d,d,!1,e)}}):(g=this.store.newItem(c,k))&&void 0!=e&&this.pasteItem(g,d,d,!1,e)},pasteItem:function(c,d,
e,k,h){var l=this.store,b=this.childrenAttrs[0];d&&g.forEach(this.childrenAttrs,function(a){if(l.containsValue(d,a,c)){if(!k){var f=g.filter(l.getValues(d,a),function(a){return a!=c});l.setValues(d,a,f)}b=a}});if(e)if("number"==typeof h){var a=l.getValues(e,b).slice();a.splice(h,0,c);l.setValues(e,b,a)}else l.setValues(e,b,l.getValues(e,b).concat(c))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(c,d){d&&this.getChildren(d.item,h.hitch(this,function(c){this.onChildrenChange(d.item,
c)}))},onDeleteItem:function(c){this.onDelete(c)},onSetItem:function(c,d){if(-1!=g.indexOf(this.childrenAttrs,d))this.getChildren(c,h.hitch(this,function(d){this.onChildrenChange(c,d)}));else this.onChange(c)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(g,m,q,h,c){return m("dijit.tree.ForestStoreModel",c,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(c){this.root=
{store:this,root:!0,id:c.rootId,label:c.rootLabel,children:c.rootChildren}},mayHaveChildren:function(c){return c===this.root||this.inherited(arguments)},getChildren:function(c,e,g){c===this.root?this.root.children?e(this.root.children):this.store.fetch({query:this.query,onComplete:h.hitch(this,function(c){this.root.children=c;e(c)}),onError:g}):this.inherited(arguments)},isItem:function(c){return c===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(c){if(c.identity==this.root.id){var d=
c.scope||q.global;c.onItem&&c.onItem.call(d,this.root)}else this.inherited(arguments)},getIdentity:function(c){return c===this.root?this.root.id:this.inherited(arguments)},getLabel:function(c){return c===this.root?this.root.label:this.inherited(arguments)},newItem:function(c,e,g){return e===this.root?(this.onNewRootItem(c),this.store.newItem(c)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(c,e,g,h,l){if(e===this.root&&!h)this.onLeaveRoot(c);this.inherited(arguments,[c,
e===this.root?null:e,g===this.root?null:g,h,l]);if(g===this.root)this.onAddToRoot(c)},onAddToRoot:function(c){console.log(this,": item ",c," added to root")},onLeaveRoot:function(c){console.log(this,": item ",c," removed from root")},_requeryTop:function(){var c=this.root.children||[];this.store.fetch({query:this.query,onComplete:h.hitch(this,function(e){this.root.children=e;if(c.length!=e.length||g.some(c,function(c,d){return e[d]!=c}))this.onChildrenChange(this.root,e)})})},onNewItem:function(c,
e){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(c){-1!=g.indexOf(this.root.children,c)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(c,e,g,h){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(g,m,q,h,c,d,e,k,p,l,b){return m("dijit.tree._dndSelector",
b,{constructor:function(){this.selection={};this.anchor=null;this.events.push(k(this.tree.domNode,p.press,h.hitch(this,"onMouseDown")),k(this.tree.domNode,p.release,h.hitch(this,"onMouseUp")),k(this.tree.domNode,p.move,h.hitch(this,"onMouseMove")),k(this.tree.domNode,l.press,h.hitch(this,"onClickPress")),k(this.tree.domNode,l.release,h.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);
return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var b=g.filter(this.getSelectedTreeNodes(),function(b){return!d.isDescendant(b.domNode,a.domNode)});this.setSelection(b);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},setSelection:function(a){var b=this.getSelectedTreeNodes();g.forEach(this._setDifference(b,
a),h.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));g.forEach(this._setDifference(a,b),h.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){g.forEach(b,function(a){a.__exclude__=!0});a=g.filter(a,function(a){return!a.__exclude__});g.forEach(b,function(a){delete a.__exclude__});return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=
[],c=[];g.forEach(a,function(a){var f=a.getTreePath();c.push(a);b.push(f)},this);a=g.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,this.current))){"mousedown"==a.type&&e.isLeft(a)&&a.preventDefault();
var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var d=c.getCopyKeyState(a),g=b.id;this.singular||a.shiftKey||!this.selection[g]?(this._doDeselect=!1,this.userSelect(b,d,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,c.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,
b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);a=doc.createRange();a.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(a,b,c){if(this.singular)this.anchor==
a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,b){b=b||q.global;for(var c in this.selection)a.call(b,
this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(g,m,q,h,c,d){return m("dijit.tree._dndContainer",null,{constructor:function(e,k){this.tree=e;this.node=e.domNode;h.mixin(this,k);this.containerState="";q.add(this.node,"dojoDndContainer");this.events=[c(this.node,d.enter,h.hitch(this,"onOverEvent")),c(this.node,d.leave,h.hitch(this,"onOutEvent")),g.after(this.tree,"_onNodeMouseEnter",
h.hitch(this,"onMouseOver"),!0),g.after(this.tree,"_onNodeMouseLeave",h.hitch(this,"onMouseOut"),!0),c(this.node,"dragstart, selectstart",function(c){c.preventDefault()})]},destroy:function(){for(var c;c=this.events.pop();)c.remove();this.node=this.parent=null},onMouseOver:function(c){this.current=c},onMouseOut:function(){this.current=null},_changeState:function(c,d){var e="dojoDnd"+c;c=c.toLowerCase()+"State";q.replace(this.node,e+d,e+this[c]);this[c]=d},_addItemClass:function(c,d){q.add(c,"dojoDndItem"+
d)},_removeItemClass:function(c,d){q.remove(c,"dojoDndItem"+d)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/LayerChooserFromMapLite":function(){define("dojo/on dojo/_base/declare dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMap jimu/LayerStructure".split(" "),function(g,m,q,h,c,d,e,k,p){var l=m([k],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"treeSection" class\x3d"tree-section"\x3e\x3cul data-dojo-attach-point\x3d"treeUl" class\x3d"tree-ul tree-root-ul"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e',
map:null,layerStateController:null,layerState:null,customFilter:null,onlySelectLeafLayer:!1,displayLayerTypeIcon:!0,showTables:!0,viewMode:!1,onlyShowWebMapLayers:!1,layerStructure:null,_layerDatas:null,_eventHandles:null,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){c.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");c.addClass(this.domNode,"jimu-basic-layer-chooser-from-map-lite");this._layerDatas={};this._eventHandles=[];this.layerStructure=
this.map?p.createInstance(this.map):p.getInstance();this.layerInfosObj=this.layerStructure._layerInfos;this.layerState=this._clearLayerState(this.layerState)||{};this.layerStateController||(this.layerStateController=new l.LayerStateController);var b;b=this.customFilter?h.hitch(this,this.customFilter):h.hitch(this,this.filter);this.filter=k.andCombineFilters([this.basicFilter,b]);this._createTree()},_createTree:function(){var b,a;this.onlyShowWebMapLayers?(b=this.layerStructure.getWebmapLayerNodes(),
a=this.layerStructure.getWebmapTableNodes()):(b=this.layerStructure.getLayerNodes(),a=this.layerStructure.getTableNodes());0<this._createLayerNodes(b.concat(this.showTables?a:[]),this.treeUl)&&(c.setStyle(this.errorTipSection,"display","none"),this.layerStateController.restoreState(this.layerState,this.layerStructure))},_createLayerNodes:function(b,a){var c=d.map(b,function(a){return this.filter(a._layerInfo)},this),e=0;q(c).then(h.hitch(this,function(c){d.forEach(c,function(c,f){c&&(this._createLayerNode(b[f],
a),e++)},this)}));return e},_createLayerNode:function(b,a){var f=c.create("li",{"class":"tree-node-li",id:"layerchooserlite-tree-node-li-"+b.id},a),d=c.create("div",{"class":"tree-node-div"},f);a=c.create("span",{"class":"tree-node-column-span collapse-span"},d);var k=c.create("span",{"class":"tree-node-column-span check-box-span"},d),k=c.create("div",{"class":"tree-node-column-div check-box-div"},k),l=c.create("span",{"class":"tree-node-column-span icon-span "+(this.displayLayerTypeIcon?"display":
"")},d),m;m=(m=this.layerState[b.id])?m.selected:this.layerStateController.getState(b);m=new e({checked:m},k);var p=c.create("span",{"class":"tree-node-column-span title-span",innerHTML:b.title},d),q=c.create("ul",{"class":"tree-ul tree-subnode-ul",style:"display:none; "},f),f={layerNode:b,layerNodeLi:f,layerNodeDiv:d,collapseSpan:a,iconSpan:l,checkBox:m,subLayerNodeUl:q,hasBeenOpened:!1};this._layerDatas[b.id]=f;b.isLeaf()||(c.addClass(a,"is-leaf"),c.addClass(p,"is-leaf"),b=g(a,"click",h.hitch(this,
this._onCollapse,f)),this._eventHandles.push(b),b=g(p,"click",h.hitch(this,this._onCollapse,f)),this._eventHandles.push(b),this.onlySelectLeafLayer&&(m.setStatus(!1),c.setStyle(k,"display","none")));!0===this.viewMode&&m.setStatus(!1);b=g(m.domNode,"click",h.hitch(this,this._onCheckBoxChange,f));this._eventHandles.push(b);this._setIconImage(f,!1);return f},_setIconImage:function(b,a){if(this.displayLayerTypeIcon){var f=b.layerNode,d=f.getLayerType(),e=f.getLayerObject();q({layerType:d,layerObject:e}).then(h.hitch(this,
function(d){var e;d.layerType&&d.layerObject&&(e={type:d.layerType,layerInfo:f._layerInfo},d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),(e=this._getIconInfo(e,a).imageName)&&c.setStyle(b.iconSpan,"background-image","url("+d+"/css/images/"+e+")"))}))}},_getCheckBoxValue:function(b){return b.getStatus()?b.getValue():!1},_clearLayerState:function(b){var a={};b&&this.layerStructure.traversal(h.hitch(this,function(c){b[c.id]&&(a[c.id]={selected:b[c.id].selected})}));return a},
_selectOrDeselectLayer:function(b,a){if(b=this._layerDatas[b])b.checkBox.setValue(a),this._onCheckBoxChange(b)},selectLayer:function(b){this._selectOrDeselectLayer(b,!0)},deselectLayer:function(b){this._selectOrDeselectLayer(b,!1)},getState:function(){var b=h.clone(this.layerState),a;for(a in this._layerDatas)this._layerDatas.hasOwnProperty(a)&&"function"!==typeof this._layerDatas[a]&&(this._getCheckBoxValue(this._layerDatas[a].checkBox)?b[a]={selected:!0}:b[a]={selected:!1});return b},restoreState:function(b){this.layerState=
this._clearLayerState(b);for(var a in this._layerDatas)if(this._layerDatas.hasOwnProperty(a)&&"function"!==typeof this._layerDatas[a]){var c=(b=this._layerDatas[a])&&b.checkBox,d=this.layerState[a];d?c.setValue(d.selected):c.setValue(this.layerStateController.getState(b.layerNode))}this.layerStateController.restoreState(this.layerState,this.layerStructure)},setViewMode:function(b){for(var a in this._layerDatas)if(this._layerDatas.hasOwnProperty(a)&&"function"!==typeof this._layerDatas[a]){var c=this._layerDatas[a],
c=c&&c.checkBox;!0===b?(this.viewMode=!0,c.setStatus(!1)):(this.viewMode=!1,c.setStatus(!0))}},getSelectedLayerNodes:function(){var b=[],a=this.getState(),c;for(c in a)if(a.hasOwnProperty(c)&&"function"!==typeof a[c]&&a[c].selected){var d=this.layerStructure.getNodeById(c);d&&b.push(d)}return b},getLoadedLayerNodes:function(){var b=[],a;for(a in this._layerDatas)if(this._layerDatas.hasOwnProperty(a)&&"function"!==typeof this._layerDatas[a]){var c=this.layerStructure.getNodeById(a);c&&b.push(c)}return b},
getLayerAssociateDomNodesById:function(b){var a=null;(b=this._layerDatas[b])&&(a={collapseIcon:b.collapseSpan,checkBox:b.checkBox.domNode,layerTypeIcon:b.iconSpan});return a},getSelectedItems:function(){var b=[];return b=d.map(this.getSelectedLayerNodes(),function(a){return{name:a.title,url:a.getUrl(),layerInfo:a._layerInfo}},this)},getAllItems:function(){return[]},_clear:function(){this._layerDatas={};d.forEach(this._eventHandles,function(b){b.remove()},this);this._eventHandles=[];c.empty(this.treeUl)},
destroy:function(){this._clear();this.map&&this.layerStructure.destroy();this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)},_onCollapse:function(b){var a="none"===c.getStyle(b.subLayerNodeUl,"display")?!0:!1;a?(c.setStyle(b.subLayerNodeUl,"display","block"),c.addClass(b.collapseSpan,"opened")):(c.setStyle(b.subLayerNodeUl,"display","none"),c.removeClass(b.collapseSpan,"opened"));this._setIconImage(b,a);b.hasBeenOpened||(this._createLayerNodes(b.layerNode.getSubNodes(),
b.subLayerNodeUl),b.hasBeenOpened=!0)},_onCheckBoxChange:function(b,a){this.layerStateController.setState(b.layerNode,this._getCheckBoxValue(b.checkBox));this.emit("selection-change",b.layerNode,this._getCheckBoxValue(b.checkBox));this._onTreeClick(b,a)},_onLayerInfosChanged:function(){this._createTree();this.emit("update")},_onLayerInfosIsShowInMapChanged:function(){this._createTree();this.emit("update")},_onTreeClick:function(b,a){b={name:b.layerNode.title||"",parent:null,layerInfo:b.layerNode._layerInfo,
type:null,layerClass:null,id:null,isLeaf:b.layerNode.isLeaf(),hasChildren:b.layerNode.isLeaf()?!1:!0};this.emit("tree-click",b,null,a)}});l.LayerStateController=m(null,{getState:function(b){return!0},setState:function(b,a){return this},restoreState:function(b,a){return this}});l.LayerVisibilityStateController=m(l.LayerStateController,{getState:function(b){return b.isToggledOn()},setState:function(b,a){b.toggle();return this},restoreState:function(b,a){var c={layerOptions:{}},d;for(d in b)b.hasOwnProperty(d)&&
"function"!==typeof b[d]&&(c.layerOptions[d]={visible:b[d].selected});a.restoreState(c);return this}});l.layerVisibilityStateController=new l.LayerVisibilityStateController;l.LayerLegendStateController=m(l.LayerStateController,{getState:function(b){return b.isShowLegend()}});l.layerLegendStateController=new l.LayerLegendStateController;return l})},"jimu/dijit/ColorPickerButton":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorSelector".split(" "),
function(g,m,q,h,c,d,e,k,p,l){return g([m,q],{baseClass:"jimu-color-picker-btn",declaredClass:"jimu.dijit.ColorPickerButton",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"color-node" data-dojo-attach-point\x3d"colorNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"seperator"\x3e\x3c/div\x3e\x3cdiv class\x3d"action-node" data-dojo-attach-point\x3d"actionNode"\x3e\x3c/div\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,postMixInProperties:function(){this.nls=
window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof e||(this.color=new e(this.color)):this.color=new e("#ccc");c.setStyle(this.colorNode,"backgroundColor",this.color.toHex());this.colorNode.title=this.color.toHex();this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog();this.own(d(this.colorNode,"click",h.hitch(this,this._onNodeClick)));this.own(d(this.actionNode,"click",h.hitch(this,this._onNodeClick)));
this.own(d(document.body,"click",h.hitch(this,function(b){this.isPartOfPopup(b.target||b.srcElement)||this._hideTooltipDialog()})))},_onNodeClick:function(b){b.stopPropagation();b.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()},destroy:function(){p.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(b){var a=this.tooltipDialog.domNode;return b===a||c.isDescendant(b,a)},hideTooltipDialog:function(){this._hideTooltipDialog()},
_showTooltipDialog:function(){p.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){p.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var b=c.create("div");this.tooltipDialog=new k({content:b});c.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");this.picker=new l({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:h.hitch(this,
function(a){this.ensureMode||(a=new e(a),this.setColor(a))})});this.picker.placeAt(b);this.picker.startup();if(this.ensureMode){var a=c.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing jimu-leading-margin1",title:this.nls.cancel,innerHTML:this.nls.cancel},b);this.own(d(a,"click",h.hitch(this,function(){this._hideTooltipDialog()})));a=c.create("div",{"class":"jimu-btn jimu-float-trailing jimu-leading-margin1",title:this.nls.ok,innerHTML:this.nls.ok},b);this.own(d(a,"click",h.hitch(this,
function(){var a=this.picker.get("value");this.setColor(new e(a));this._hideTooltipDialog()})));b=c.create("div",{"class":"jimu-btn jimu-float-trailing jimu-leading-margin1",title:this.nls.apply,innerHTML:this.nls.apply},b);this.own(d(b,"click",h.hitch(this,function(){var a=this.picker.get("value");this.setColor(new e(a))})))}},setColor:function(b){if(b instanceof e){var a=this.color,d="";a&&(d=a.toHex());a=b.toHex();this.color=b;c.setStyle(this.colorNode,"backgroundColor",a);d!==a&&(this.picker.set("value",
a),this.onChange(new e(a)))}},getColor:function(){return this.color},onChange:function(b){}})})},"widgets/Select/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Select/setting/Setting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.chooseSelectingTools}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"drawingToolsContainer" class\x3d"drawing-tools-container jimu-draw-box" data-dojo-attach-event\x3d"onclick:_onDrawingToolsContainerClicked"\x3e\r\n      \x3cdiv class\x3d"draw-item point-icon" title\x3d"${nls.selectByPoint}" data-geotype\x3d"POINT"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item polyline-icon" title\x3d"${nls.selectByLine}" data-geotype\x3d"POLYLINE"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item extent-icon" title\x3d"${nls.selectByRectangle}" data-geotype\x3d"EXTENT"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item circle-icon" title\x3d"${nls.selectByCircle}" data-geotype\x3d"CIRCLE"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item polygon-icon" title\x3d"${nls.selectByPolygon}" data-geotype\x3d"POLYGON"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item freehand-polygon-icon" title\x3d"${nls.selectByFreehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"config-section inline"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.setSelectionColor}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"colorPicker" data-dojo-type\x3d"jimu/dijit/ColorPickerButton"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.selectionMode}\x3c/div\x3e\r\n    \x3cdiv class\x3d"option"\x3e\r\n      \x3cinput id\x3d"selectModePartial" name\x3d"selectionMode" data-dojo-type\x3d"dijit/form/RadioButton"\r\n        data-dojo-attach-point\x3d"partialMode"/\x3e\r\n      \x3clabel for\x3d"selectModePartial"\x3e${nls.partiallyWithin}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"option"\x3e\r\n      \x3cinput id\x3d"selectModeWhole" name\x3d"selectionMode" data-dojo-type\x3d"dijit/form/RadioButton"\r\n        data-dojo-attach-point\x3d"whollyMode"/\x3e\r\n      \x3clabel for\x3d"selectModeWhole"\x3e${nls.whollyWithin}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"exportCheckBoxDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"runtimeLayersCheckBoxDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.layerToSelect}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-chooser" data-dojo-attach-point\x3d"layerChooserDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Select/setting/css/style.css":".jimu-widget-select-setting {margin: 20px 0;}.jimu-widget-select-setting .config-section {width: 100%; margin-bottom: 20px;}.jimu-widget-select-setting .config-section label {color: #353535; font-size: 12px;}.jimu-widget-select-setting .config-section .jimu-color-picker {width: 30px; height: 30px; margin: 0 20px;}.jimu-widget-select-setting .config-section .option {margin: 15px;}.jimu-widget-select-setting .config-section .option input {margin: 0 10px;}.jimu-widget-select-setting .inline \x3e div {display: inline-block; vertical-align: middle;}.jimu-widget-select-setting .label {color: #353535; font-size: 14px;}.jimu-widget-select-setting .drawing-tools-container {margin-top: 5px; overflow: hidden;}.jimu-widget-select-setting .drawing-tools-container .draw-item {float: left; width: 48px; height: 48px; cursor: pointer; background-repeat: no-repeat; background-position: center center; margin-left: 5px; position: relative; border: 1px solid #DBDBDB; border-radius: 1px; color: #666; font-size: 24px; padding: 12px;}.jimu-widget-select-setting .drawing-tools-container .draw-item.point-icon {padding: 12px 17px;}.jimu-rtl .jimu-widget-select-setting .drawing-tools-container .draw-item {float: right; margin-left: 0; margin-right: 5px;}.jimu-widget-select-setting .drawing-tools-container .draw-item:first-child {margin-left: 0 !important; margin-right: 0 !important;}.jimu-widget-select-setting .drawing-tools-container .draw-item .draw-item-icon {position: absolute; left: 2px; top: 2px; width: 16px; height: 16px; display: none; background: url(images/checked.png) center center no-repeat; background-color: #fff;}.jimu-rtl .jimu-widget-select-setting .drawing-tools-container .draw-item .draw-item-icon {left: auto; right: 2px;}.jimu-widget-select-setting .drawing-tools-container .draw-item.selected .draw-item-icon {display: block;}.jimu-widget-select-setting .jimu-basic-layer-chooser-from-map-lite .check-box-div.jimu-state-disabled {display: none;}",
"*now":function(g){g(['dojo/i18n!*preload*widgets/Select/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/on dojo/_base/array dojo/query dojo/_base/html dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMap jimu/dijit/LayerChooserFromMapLite jimu/dijit/ColorPickerButton dijit/form/RadioButton".split(" "),function(g,m,q,h,c,d,e,k,p,l,b,a){return g([p,k],{baseClass:"jimu-widget-select-setting",selectionColor:"",selectionMode:"",allowExport:!1,postMixInProperties:function(){this.inherited(arguments);
m.mixin(this.nls,window.jimuNls.featureSetChooser)},postCreate:function(){this.inherited(arguments);this.allowExportCheckBox=new l({label:this.nls.allowExport,checked:this.config&&this.config.allowExport,onChange:m.hitch(this,this._onAllowExportChange)},this.exportCheckBoxDiv);this.includeRuntimeLayersCheckBox=new l({label:this.nls.includeRuntimeLayers,checked:this.config&&!1!==this.config.includeRuntimeLayers,onChange:m.hitch(this,this._onIncludeRuntimeLayersChange)},this.runtimeLayersCheckBoxDiv);
this.config&&this._init();this.own(h(this.partialMode,"click",m.hitch(this,this._onSelectPartialMode)));this.own(h(this.whollyMode,"click",m.hitch(this,this._onSelectWhollyMode)));this.own(h(this.colorPicker,"change",m.hitch(this,this._onColorChange)))},_onColorChange:function(a){this.selectionColor=a.toHex()},_onSelectPartialMode:function(){this.selectionMode="partial"},_onSelectWhollyMode:function(){this.selectionMode="wholly"},_onAllowExportChange:function(a){this.allowExport=a},_onIncludeRuntimeLayersChange:function(a){this.includeRuntimeLayers=
a},_init:function(){(this.selectionColor=this.config.selectionColor)&&this.colorPicker.setColor(new q(this.selectionColor));this.selectionMode=this.config.selectionMode;"partial"===this.config.selectionMode?(this.partialMode.set("checked",!0),this._onSelectPartialMode()):"wholly"===this.config.selectionMode&&(this.whollyMode.set("checked",!0),this._onSelectWhollyMode());this.allowExport=this.config.allowExport;this.allowExportCheckBox.setValue(this.allowExport);this.includeRuntimeLayers=!1!==this.config.includeRuntimeLayers;
this.includeRuntimeLayersCheckBox.setValue(this.includeRuntimeLayers);this._selectDrawingTools(this.config.geometryTypes||["EXTENT"]);if(this.layerChooser)this.config.layerState&&this.layerChooser.restoreState(this.config.layerState);else{var c=b.createFeaturelayerFilter(null,!0,!1,!1);this.layerChooser=new a({customFilter:c,onlySelectLeafLayer:!0,onlyShowWebMapLayers:!0,layerState:this.config.layerState});this.layerChooser.placeAt(this.layerChooserDiv);this.layerChooser.startup()}},setConfig:function(a){this.config=
a;this._init()},getConfig:function(){return{selectionColor:this.selectionColor,selectionMode:this.selectionMode,allowExport:this.allowExport,includeRuntimeLayers:this.includeRuntimeLayers,geometryTypes:this._getSelectedDrawingTools(),layerState:this.layerChooser.getState()}},_onDrawingToolsContainerClicked:function(a){a=a.target||a.srcElement;var b=null;e.hasClass(a,"draw-item")?b=a:e.hasClass(a,"draw-item-icon")&&(b=a.parentNode);b&&(e.toggleClass(b,"selected"),0===d(".selected",this.drawingToolsContainer).length&&
e.addClass(b,"selected"))},_selectDrawingTools:function(a){var b=d(".draw-item",this.drawingToolsContainer);c.forEach(b,m.hitch(this,function(b){var c=b.getAttribute("data-geotype");0<=a.indexOf(c)?e.addClass(b,"selected"):e.removeClass(b,"selected")}))},_getSelectedDrawingTools:function(){var a=[],a=d(".draw-item.selected",this.drawingToolsContainer);return a=c.map(a,m.hitch(this,function(a){return a.getAttribute("data-geotype")}))}})});